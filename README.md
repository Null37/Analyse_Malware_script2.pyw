# analyse_malware



# File details 

- MD5: 5fd5417d7f5ccac9f98eb7962124364a
- SHA-256 : d9cc83e458218e6e1ebcb9fa3f5413ecf7dbc2a15761df30d775b1deb2e3f11a

### file name : script2.pyw, script2.py

# secript2.pyw sample 



![malware](https://cdn.discordapp.com/attachments/691741851648262195/1161038040471445594/image.png?ex=6536d7ef&is=652462ef&hm=fd65a864a8993c279f57ac6f1bd316e9c669cdb4f37454b7097f9d53d90d5159&)


As you can see, the malware file has a class name 'Berserker'. Berserker is a Python obfuscator tool, and a Python obfuscator is a mechanism used to obfuscate and obscure Python code, making it unclear and difficult to understand. This is done to protect the code from reverse engineers and deceive antivirus programs that rely on digital signatures to interpret the code.

Link of the Berserker tool: https://github.com/billythegoat356/Berserker

# Deobfuscate 

After searching, I found a tool named 'berserkered' used to deobfuscate Python code obfuscated by Berserker : https://github.com/namdevel/berserkered


I have python Python 3.11.5 after editing the code main.py to deobfuscate malware the result :

the berserkered.py :
```
import os, sys, re
import subprocess
  
def write(file_name, data):
    f = open(file_name, "w")
    f.write(data)
    f.close()


if __name__ == "__main__":

    obf_file = "script2.pyw"  # obfuscated file

    with open(obf_file) as code:
        data = code.read()
        
        s1 = re.search("if self.(.+?) in open", data).group(1)
        s1s = s1.replace("15", "12")
        s2 = re.findall("{(.+?)}", data)

        source = (
            data.replace(s1, s1s)
            .replace("{" + s2[0] + "}", "print")
            .replace(",{" + s2[1] + "}()", "")
        )
        write('tmpfile.py', source)
        subprocess.run(["python", "tmpfile.py"])
        os.unlink('tmpfile.py')

```
the malware after deobfuscate ![malware_deb](https://cdn.discordapp.com/attachments/691741851648262195/1161043431309717654/image.png?ex=6536dcf5&is=652467f5&hm=e72dde7a5cd17d809260b72884bf66642176136a2e56e08247867ac23894d2df&)






